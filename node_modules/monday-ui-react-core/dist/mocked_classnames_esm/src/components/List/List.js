import{slicedToArray as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as r}from"react/jsx-runtime";import e from"classnames";import i,{forwardRef as s,useRef as o,useState as n,useCallback as a,useMemo as l}from"react";import c from"../../hooks/useMergeRef.js";import m from"../../hooks/useKeyEvent/index.js";import{VirtualizedListItems as d}from"./VirtualizedListItems/VirtualizedListItems.js";import{keyCodes as u,UP_DOWN_ARROWS as f}from"../../constants/keyCodes.js";import{withStaticProps as p}from"../../types/withStaticProps.js";import{ListWrapperComponentType as v}from"./ListConstants.js";import{getTestId as b,ComponentDefaultTestId as j}from"../../tests/testIds.js";import{ListContext as y}from"./utils/ListContext.js";import{useListId as h,getListItemIndexById as L,getNextListItemIndex as I,getPrevListItemIndex as k,getListItemIdByIndex as x,getListItemComponentType as g}from"./utils/ListUtils.js";import A from"./List.module.scss.js";var O=s((function(s,p){var v=s.className,R=s.id,C=s.component,P=void 0===C?O.components.UL:C,V=s.children,_=s.ariaLabel,D=s.ariaDescribedBy,E=s["aria-controls"],N=s.renderOnlyVisibleItems,U=void 0!==N&&N,W=s.style,z=s["data-testid"],B=o(null),S=c(p,B),T=o([]),w=h(R),F=n(0),H=t(F,2),K=H[0],M=H[1],q=P,G=a((function(t){var r;M(L(T,t)),null===(r=null==B?void 0:B.current)||void 0===r||r.setAttribute("aria-activedescendant",t)}),[]),J=a((function(t){if(!U){t.preventDefault();var r=t.key===u.UP_ARROW,e=void 0;t.key===u.DOWN_ARROW&&T.current.length>K+1?e=I(K,T):r&&K>0&&(e=k(K,T)),void 0!==e&&(G(x(T,e)),T.current[e].focus())}}),[K,U,G]);m({keys:f,callback:J,ref:B});var Q=l((function(){var t=Array.isArray(V)?V:[V];return U?t=r(d,{children:t}):(T.current=T.current.slice(0,t.length),t=i.Children.map(t,(function(t,r){if(!i.isValidElement(t))return t;var e=t.props.id||"".concat(w,"-item-").concat(r);return i.cloneElement(t,{ref:function(t){return T.current[r]=t},tabIndex:K===r?0:-1,id:e,component:g(P)})}))),t}),[V,P,K,w,U]);return r(y.Provider,Object.assign({value:{updateFocusedItem:G}},{children:r(q,Object.assign({"data-testid":z||b(j.LIST,R),ref:S,style:W,className:e(A.list,v),id:w,"aria-label":_,"aria-describedby":D,"aria-controls":E,tabIndex:-1,role:"listbox"},{children:Q}))}))})),R=p(O,{components:v});export{R as default};
//# sourceMappingURL=List.js.map
