import{slicedToArray as e,defineProperty as o}from"../../../../_virtual/_rollupPluginBabelHelpers.js";import i,{forwardRef as n,useRef as t,useEffect as s,useLayoutEffect as r,useCallback as l,useMemo as a,createElement as c}from"react";import{jsx as u,jsxs as m}from"react/jsx-runtime";import d from"classnames";import{isFunction as p}from"lodash-es";import{getTestId as v,ComponentDefaultTestId as f}from"../../../tests/testIds.js";import{DialogPosition as I}from"../../../constants/positions.js";import b from"../../Text/Text.js";import h from"../../Tooltip/Tooltip.js";import M from"../../Icon/Icon.js";import j from"../../DialogContentContainer/DialogContentContainer.js";import y from"../../../hooks/useMergeRef.js";import g from"../../../hooks/useIsOverflowing/useIsOverflowing.js";import C from"../../../hooks/usePopover.js";import{backwardCompatibilityForProperties as k}from"../../../helpers/backwardCompatibilityForProperties.js";import O from"./hooks/useMenuItemMouseEvents.js";import x from"./hooks/useMenuItemKeyboardEvents.js";import{withStaticProps as S}from"../../../types/withStaticProps.js";import{TAB_INDEX_FOCUS_WITH_JS_ONLY as E}from"./MenuItemConstants.js";import N from"../../Label/Label.js";import T from"./MenuItem.module.scss.js";import B from"../../IconButton/IconButton.js";import D from"../../Divider/Divider.js";import{DirectionType as L}from"../../Divider/DividerConstants.js";import w from"../../../hooks/useIsMouseEnter.js";import R from"../../Icon/Icons/components/DropdownChevronRight.js";var P=n((function(n,I){var S,A=n.iconWrapperClassName,V=n.title,F=void 0===V?"":V,W=n.label,_=void 0===W?"":W,z=n.icon,G=void 0===z?"":z,H=n.menuRef,q=n.iconType,K=n.iconBackgroundColor,U=n.disabled,X=void 0!==U&&U,Y=n.disableReason,J=n.selected,Q=void 0!==J&&J,Z=n.onClick,$=n.activeItemIndex,ee=void 0===$?-1:$,oe=n.setActiveItemIndex,ie=n.index,ne=n.key,te=n.id,se=n.children,re=n.isParentMenuVisible,le=void 0!==re&&re,ae=n.resetOpenSubMenuIndex,ce=n.hasOpenSubMenu,ue=void 0!==ce&&ce,me=n.setSubMenuIsOpenByIndex,de=n.closeMenu,pe=n.useDocumentEventListeners,ve=void 0!==pe&&pe,fe=n.tooltipContent,Ie=n.tooltipPosition,be=void 0===Ie?P.tooltipPositions.RIGHT:Ie,he=n.tooltipShowDelay,Me=void 0===he?300:he,je=n.tooltipProps,ye=n.isInitialSelectedState,ge=n.onMouseEnter,Ce=n.onMouseLeave,ke=n.shouldScrollMenu,Oe=n["data-testid"],xe=n.splitMenuItem,Se=void 0!==xe&&xe,Ee=k([n.className,n.classname]),Ne=ee===ie,Te=!!se,Be=Te&&Ne&&ue,De=Te&&le&&Be,Le=se&&i.Children.only(se);Le&&Le.type&&Le.type.isMenu?S=Le:Le&&console.error("menu item can accept only menu element as first level child, this element is not valid: ",Le);var we=t(),Re=t(),Pe=t(null),Ae=t(null),Ve=t(null),Fe=Ve.current,We=Pe.current,_e=Re.current,ze=y(I,Pe),Ge=w({ref:Pe}),He=w({ref:Ae}),qe=g({ref:we}),Ke=C(We,Fe,{isOpen:Be}),Ue=Ke.styles,Xe=Ke.attributes;s((function(){var e;Ne&&ke&&We&&(We.scrollIntoViewIfNeeded?We.scrollIntoViewIfNeeded({behaviour:"smooth"}):null===(e=We.scrollIntoView)||void 0===e||e.call(We,{behavior:"smooth",block:"center"}))}),[Ne,We,ke]);var Ye=O({ref:Pe,splitMenuItemIconButtonRef:Ae,resetOpenSubMenuIndex:ae,setSubMenuIsOpenByIndex:me,isActive:Ne,setActiveItemIndex:oe,index:ie,hasChildren:Te,splitMenuItem:Se}),Je=x({onClick:Z,disabled:X,isActive:Ne,index:ie,setActiveItemIndex:oe,hasChildren:Te,shouldShowSubMenu:De,setSubMenuIsOpenByIndex:me,menuRef:H,isMouseEnter:Ye,closeMenu:de,useDocumentEventListeners:ve,splitMenuItem:Se,isMouseEnterMenuItem:Ge,isMouseEnterIconButton:He}).onClickCallback;r((function(){ve||De&&_e&&requestAnimationFrame((function(){_e.focus()}))}),[De,_e,ve]),s((function(){ve||Ne&&(null==We||We.focus())}),[Ne,We,ve]);var Qe=l((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};me(ie,!1),e.propagate&&de(e)}),[me,ie,de]),Ze=a((function(){return K?[{backgroundColor:K,borderRadius:"4px",opacity:X?.4:1},{color:"var(--text-color-on-primary)"}]:[]}),[K,X]),$e=e(Ze,2),eo=$e[0],oo=$e[1],io=a((function(){return se?{"aria-haspopup":!0,"aria-expanded":ue}:{}}),[se,ue]),no=qe||X||fe,to=a((function(){return X?Y:fe||F}),[Y,X,F,fe]);return c(b,Object.assign({element:"li",type:b.types.TEXT2},io,{key:ne,id:te,"data-testid":Oe||v(f.MENU_ITEM,ie),className:d(T.item,Ee,o(o(o(o(o({},T.disabled,X),T.focused,Ne),T.selected,Q),T.initialSelected,ye),T.splitMenuItem,Se)),ref:ze,onClick:Je,role:"menuitem","aria-current":Ne,onMouseLeave:Ce,onMouseEnter:ge,tabIndex:E}),function(){if(!G)return null;var e=q;return e||(e=p(G)?M.type.SVG:M.type.ICON_FONT),u("div",Object.assign({className:d(T.iconWrapper,A),style:eo},{children:u(M,{iconType:e,clickable:!1,icon:G,iconLabel:F,className:T.icon,ignoreFocusStyle:!0,style:oo,iconSize:18})}))}(),u(h,Object.assign({content:no?to:null,position:be,showDelay:Me,moveBy:G&&be===h.positions.LEFT?{main:30}:void 0},je,{children:u("div",Object.assign({ref:we,className:T.title},{children:F}))})),_&&u(N,{kind:N.kinds.LINE,text:_}),Te?Se?m("div",Object.assign({className:T.subMenuIconWrapper},{children:[u(D,{direction:L.VERTICAL,className:T.divider}),u(B,{icon:R,className:T.splitMenuItemIconButton,kind:B.kinds.TERTIARY,size:null,iconClassName:d(T.iconButton,o({},T.disabled,X)),tabIndex:-1,ref:Ae,active:De,disabled:X})]})):u("div",Object.assign({className:T.subMenuIconWrapper},{children:u(M,{clickable:!1,icon:R,iconLabel:F,className:T.subMenuIcon,ignoreFocusStyle:!0,iconSize:18})})):null,u("div",Object.assign({style:Object.assign(Object.assign({},Ue.popper),{visibility:De?"visible":"hidden"})},Xe.popper,{ref:Ve},{children:S&&De&&u(j,{children:i.cloneElement(S,Object.assign(Object.assign({},null==S?void 0:S.props),{isVisible:De,isSubMenu:!0,onClose:Qe,ref:Re,useDocumentEventListeners:ve}))})})))}));Object.assign(P,{isSelectable:!0,isMenuChild:!0});var A=S(P,{iconType:M.type,tooltipPositions:I});export{A as default};
//# sourceMappingURL=MenuItem.js.map
